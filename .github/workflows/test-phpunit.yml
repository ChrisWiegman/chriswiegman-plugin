name: PhpUnit Tests

on:
    push:
      branches:
        - main
        - develop
    pull_request:
      types: [opened,synchronize,ready_for_review,edited]

# Cancel previous workflow run groups that have not completed.
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build-test:
    runs-on: ubuntu-24.04
    steps:
        - name: Checkout project
          uses: actions/checkout@v5

        - name: Setup Correct PHP Version
          uses: shivammathur/setup-php@v2
          with:
            php-version: '8.4'
            tools: composer:v2
            coverage: xdebug

        - name: Install Composer dependencies
          run: |
            composer install

        - name: PHPUnit Tests
          uses: php-actions/phpunit@v4
          with:
            configuration: phpunit.xml.dist